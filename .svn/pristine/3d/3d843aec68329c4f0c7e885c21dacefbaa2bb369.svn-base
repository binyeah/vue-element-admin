webpackJsonp([22],{"2apI":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("pFYg"),l=r.n(o),i={data:function(){return{id:"",multiple:!0,coureInfo:{},ueditor:{value:"",config:{}},mapJson:"../../../static/map.json",province:"",shi1:[],qu1:[],city:"",block:"",citys:[],ptype:[],Stype:[],differ:[],courenum:[],ruleForm:{name:"",typeone:"",typetwo:"",courenum:"",singleP:"",totalP:"",date1:"",date2:"",date3:"",date4:"",coupon:"",sheng:"",shi:"",qu:"",differ:"",videoUrl:"",imageUrl1:[]},rules:{name:[{required:!0,message:"请输入课程名称",trigger:"blur"},{max:20,message:"不超过20个字符",trigger:"blur"}],typetwo:[{required:!0,message:"请选择课程类型",trigger:"change"}],courenum:[{required:!0,message:"请选择课时",trigger:"change"}],differ:[{required:!0,message:"请选择课程难度",trigger:"change"}],singleP:[{required:!0,message:"请输入单价",trigger:"blur"}],totalP:[{required:!0,message:"请输入总价",trigger:"blur"}],qu:[{required:!0,message:"请选择服务地区",trigger:"change"}],img:[{required:!0,message:"请上传详情图片",trigger:"blur"}]}}},created:function(){this.getCityData(),this.id=this.$route.query.id,this.gettypes()},methods:{gettypes:function(){var e=this,t=this.$host+"/www/yoga/admin/course/add_course";this.axios.get(t,{params:{course_id:this.id}}).then(function(t){if(console.log(t),200==t.status){var r=t.data;e.ptype=r.pcates,e.courenum=r.class_hour,e.differ=r.class_levels,e.coureInfo=r.course,null!=e.coureInfo&&(e.ruleForm.name=e.coureInfo.course_name,e.ruleForm.typeone=e.coureInfo.pid,e.ruleForm.courenum=e.coureInfo.class_id,e.ruleForm.singleP=e.coureInfo.unit_price,e.ruleForm.totalP=e.coureInfo.total_price,e.ruleForm.date1=e.coureInfo.course_start_time,e.ruleForm.date2=e.coureInfo.course_end_time,e.ruleForm.date3=e.coureInfo.coupon_start_time,e.ruleForm.date4=e.coureInfo.coupon_end_time,e.ruleForm.coupon=e.coureInfo.coupon_amount,e.ruleForm.differ=e.coureInfo.course_level,e.ruleForm.videoUrl=e.coureInfo.course_video,e.ruleForm.imageUrl1=e.coureInfo.course_cover,e.citys=e.coureInfo.service_region,e.ueditor.value=e.coureInfo.description,e.chooseStype(1))}else e.$message.error("网络错误！请稍后重试！")})},chooseStype:function(e){var t=this;console.log(e);var r={pid:this.ruleForm.typeone},o=this.$host+"/www/yoga/admin/cate/show_child";this.axios.post(o,r).then(function(r){if(console.log(r),200==r.status){var o=r.data;t.Stype=o.result,0!=t.Stype.length?t.ruleForm.typetwo=1==e?Number(t.coureInfo.sid):t.Stype[0].id:t.ruleForm.typetwo=""}else t.$message.error("网络错误！请稍后重试！")}),console.log(this.ruleForm.typetwo)},getCityData:function(){var e=this;this.axios.get(this.mapJson).then(function(t){if(200==t.status){var r=t.data;for(var o in e.province=[],e.city=[],e.block=[],r)o.match(/0000$/)?e.province.push({id:o,value:r[o],children:[]}):o.match(/00$/)?e.city.push({id:o,value:r[o],children:[]}):e.block.push({id:o,value:r[o]});for(var l in e.province)for(var i in e.city)e.province[l].id.slice(0,2)===e.city[i].id.slice(0,2)&&e.province[l].children.push(e.city[i]);for(var s in e.city)for(var a in e.block)e.block[a].id.slice(0,4)===e.city[s].id.slice(0,4)&&e.city[s].children.push(e.block[a])}}).catch(function(e){console.log(l()(+e))})},choseProvince:function(e){for(var t in console.log(e),this.province)e===this.province[t].value&&(this.shi1=this.province[t].children,this.shi=this.province[t].children[0].value,this.qu1=this.province[t].children[0].children,this.qu=this.province[t].children[0].children[0].value,this.E=this.qu1[0].value)},choseCity:function(e){for(var t in this.city)e===this.city[t].value&&(this.qu1=this.city[t].children,this.qu=this.city[t].children[0].value,this.E=this.qu1[0].value)},choseBlock:function(e){this.E=e},add:function(){var e=[];""!=this.ruleForm.qu?(e.push(this.ruleForm.sheng,this.ruleForm.shi,this.ruleForm.qu),this.citys.push(e)):this.$message.error("请选择服务区！")},delcity:function(e){this.citys.splice(e,1)},handleVideoSuccess:function(e,t){this.ruleForm.videoUrl=e.dest},delvideo:function(){this.ruleForm.videoUrl=""},handlePreview:function(e){var t=e.dest;this.ruleForm.imageUrl1.push(t)},del:function(e){this.ruleForm.imageUrl1.splice(e,1)},save:function(){var e=this;this.ueditor.value=this.$refs.ue.getUEContent();var t={course_id:this.id,course_name:this.ruleForm.name,pid:this.ruleForm.typeone,sid:this.ruleForm.typetwo,course_level:this.ruleForm.differ,class_id:this.ruleForm.courenum,unit_price:this.ruleForm.singleP,total_price:this.ruleForm.totalP,course_start_time:this.ruleForm.date1,course_end_time:this.ruleForm.date2,coupon_amount:this.ruleForm.coupon,coupon_start_time:this.ruleForm.date3,coupon_end_time:this.ruleForm.date4,service_region:this.citys,course_video:this.ruleForm.videoUrl,course_cover:this.ruleForm.imageUrl1,description:this.ueditor.value},r=this.$host+"/www/yoga/admin/course/save_course";this.axios.post(r,t).then(function(t){if(console.log(t),200==t.status){var r=t.data;e.$message({message:r.msg,type:"success"}),e.$router.push("/courelist")}else e.$message.error("网络错误！请稍后重试！")})}}},s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"addcoure"},[r("div",{staticClass:"content bg-f"},[r("div",{staticClass:"top space-between padding-24"},[r("p",[e._v("编辑课程")]),e._v(" "),r("div",{staticClass:"btn save bg-active color-f",on:{click:function(t){return e.save()}}},[e._v("保存")])]),e._v(" "),r("div",{staticClass:"mine padding-24"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"课程名称：",prop:"name"}},[r("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入课程名称"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}}),r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.ruleForm.name.length)+"/20")])],1),e._v(" "),r("el-form-item",{attrs:{label:"类型：",prop:"typetwo"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.chooseStype(2)}},model:{value:e.ruleForm.typeone,callback:function(t){e.$set(e.ruleForm,"typeone",t)},expression:"ruleForm.typeone"}},e._l(e.ptype,function(e){return r("el-option",{key:e.id,attrs:{label:e.cate_name,value:e.id}})}),1),e._v(" "),r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.typetwo,callback:function(t){e.$set(e.ruleForm,"typetwo",t)},expression:"ruleForm.typetwo"}},e._l(e.Stype,function(e){return r("el-option",{key:e.id,attrs:{label:e.cate_name,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"课时：",prop:"courenum"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.courenum,callback:function(t){e.$set(e.ruleForm,"courenum",t)},expression:"ruleForm.courenum"}},e._l(e.courenum,function(e){return r("el-option",{key:e.id,attrs:{label:e.course_number,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"难度：",prop:"differ"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.differ,callback:function(t){e.$set(e.ruleForm,"differ",t)},expression:"ruleForm.differ"}},e._l(e.differ,function(e){return r("el-option",{key:e.id,attrs:{label:e.course_level,value:e.id}})}),1)],1),e._v(" "),r("div",{staticClass:"flex"},[r("el-form-item",{attrs:{label:"单价：",prop:"singleP"}},[r("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入单价"},model:{value:e.ruleForm.singleP,callback:function(t){e.$set(e.ruleForm,"singleP",t)},expression:"ruleForm.singleP"}}),r("span",{staticStyle:{"margin-left":"10px"}},[e._v("元")])],1),e._v(" "),r("el-form-item",{attrs:{label:"总价：",prop:"totalP"}},[r("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入总价"},model:{value:e.ruleForm.totalP,callback:function(t){e.$set(e.ruleForm,"totalP",t)},expression:"ruleForm.totalP"}}),r("span",{staticStyle:{"margin-left":"10px"}},[e._v("元")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"课程有效期：",required:""}},[r("el-col",{attrs:{span:5}},[r("el-form-item",[r("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.date1,callback:function(t){e.$set(e.ruleForm,"date1",t)},expression:"ruleForm.date1"}})],1)],1),e._v(" "),r("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),r("el-col",{attrs:{span:5}},[r("el-form-item",[r("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.date2,callback:function(t){e.$set(e.ruleForm,"date2",t)},expression:"ruleForm.date2"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"设置优惠券："}},[r("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入优惠券金额"},model:{value:e.ruleForm.coupon,callback:function(t){e.$set(e.ruleForm,"coupon",t)},expression:"ruleForm.coupon"}}),r("span",{staticStyle:{"margin-left":"10px"}},[e._v("元")])],1),e._v(" "),r("el-form-item",{attrs:{label:"优惠券有效期："}},[r("el-col",{attrs:{span:5}},[r("el-form-item",[r("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.date3,callback:function(t){e.$set(e.ruleForm,"date3",t)},expression:"ruleForm.date3"}})],1)],1),e._v(" "),r("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),r("el-col",{attrs:{span:5}},[r("el-form-item",[r("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.date4,callback:function(t){e.$set(e.ruleForm,"date4",t)},expression:"ruleForm.date4"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"flex"},[r("el-form-item",{attrs:{label:"服务地址：",prop:"qu"}},[r("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择省"},on:{change:e.choseProvince},model:{value:e.ruleForm.sheng,callback:function(t){e.$set(e.ruleForm,"sheng",t)},expression:"ruleForm.sheng"}},e._l(e.province,function(e){return r("el-option",{key:e.id,attrs:{label:e.value,value:e.value}})}),1),e._v(" "),r("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择市"},on:{change:e.choseCity},model:{value:e.ruleForm.shi,callback:function(t){e.$set(e.ruleForm,"shi",t)},expression:"ruleForm.shi"}},e._l(e.shi1,function(e){return r("el-option",{key:e.id,attrs:{label:e.value,value:e.value}})}),1),e._v(" "),r("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择区"},on:{change:e.choseBlock},model:{value:e.ruleForm.qu,callback:function(t){e.$set(e.ruleForm,"qu",t)},expression:"ruleForm.qu"}},e._l(e.qu1,function(e){return r("el-option",{key:e.id,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),r("div",{staticClass:"add bg-active color-f",on:{click:e.add}},[e._v("添加")])],1),e._v(" "),r("div",{staticClass:"citylist"},[r("p",[e._v("已选城市：")]),e._v(" "),r("ul",e._l(e.citys,function(t,o){return r("li",{key:o,staticClass:"space-between"},[r("p",[e._v(e._s(t[0]+t[1]+t[2]))]),e._v(" "),r("p",{staticClass:"color-active btn",on:{click:function(t){return e.delcity(o)}}},[e._v("删除")])])}),0)]),e._v(" "),r("el-form-item",{attrs:{label:"详情头部",prop:"img"}},[r("el-upload",{staticClass:"upload-demo",attrs:{action:"https://test.izhixiu.cn/www/yoga/upload_video","show-file-list":!1,"on-success":e.handleVideoSuccess}},[r("el-button",{staticStyle:{position:"absolute",left:"10px","margin-top":"-20px"},attrs:{size:"small",type:"primary"}},[e._v("上传视频")])],1),e._v(" "),""!=e.ruleForm.videoUrl?r("div",{staticClass:"videoBox",staticStyle:{"margin-top":"20px"}},[""!=e.ruleForm.videoUrl?r("span",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.delvideo()}}},[r("i",{staticClass:"el-icon-circle-close"})]):e._e(),e._v(" "),""!=e.ruleForm.videoUrl?r("video",{staticStyle:{width:"250px",height:"120px"},attrs:{src:e.ruleForm.videoUrl,controls:""}}):e._e()]):e._e(),e._v(" "),r("el-upload",{staticClass:"upload-demo",attrs:{action:"https://test.izhixiu.cn/www/yoga/upload_file","on-success":e.handlePreview,"list-type":"picture","show-file-list":!1,multiple:e.multiple}},[r("el-button",{staticStyle:{position:"absolute",left:"10px","margin-top":"-20px"},attrs:{size:"small",type:"primary"}},[e._v("上传图片")]),e._v(" "),r("div",{staticStyle:{position:"absolute",left:"100px","margin-top":"-20px"}},[e._v("（注：建议尺寸750 *584px）")])],1),e._v(" "),""!=e.ruleForm.imageUrl1.img?r("div",{staticClass:"imgBox",staticStyle:{"margin-top":"30px"}},[r("ul",e._l(e.ruleForm.imageUrl1,function(t,o){return r("li",{key:o},[r("span",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.del(o)}}},[r("i",{staticClass:"el-icon-circle-close"})]),e._v(" "),r("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t}})])}),0)]):e._e()],1),e._v(" "),r("el-form-item",{attrs:{label:"课程介绍："}},[r("editor",{ref:"ue",attrs:{value:e.ueditor.value,config:e.ueditor.config}})],1)],1)],1)])])},staticRenderFns:[]};var a=r("VU/8")(i,s,!1,function(e){r("UVaP")},null,null);t.default=a.exports},UVaP:function(e,t){}});
//# sourceMappingURL=22.6a9c388ade3515819f94.js.map