webpackJsonp([11],{"2apI":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("pFYg"),s=i.n(r),o={data:function(){return{id:"",multiple:!0,coureInfo:{},ueditor:{value:"",config:{}},restaurants:[],typeid:[{value:""}],state:"",timeout:null,selectedtype:[],types:[{cate_name:""},{cate_name:""},{cate_name:""}],isChange:-1,isChange1:-1,isChange2:-1,mapJson:"../../../static/map.json",province:"",shi1:[],qu1:[],city:"",block:"",citys:[],ptype:[],Stype:[],differ:[],courenum:[],ruleForm:{name:"",typeone:"",typetwo:"",courenum:"",singleP:"",totalP:"",date1:"",date2:"",date3:"",date4:"",coupon:"",sheng:"",shi:"",qu:"",differ:"",videoUrl:"",imageUrl1:[],teacher:""},rules:{name:[{required:!0,message:"请输入课程名称",trigger:"blur"},{max:20,message:"不超过20个字符",trigger:"blur"}],teacher:[{required:!0,message:"请选择教练",trigger:"change"}],typetwo:[{required:!0,message:"请选择课程类型",trigger:"change"}],courenum:[{required:!0,message:"请选择课时",trigger:"change"}],differ:[{required:!0,message:"请选择课程难度",trigger:"change"}],singleP:[{required:!0,message:"请输入单价",trigger:"blur"}],totalP:[{required:!0,message:"请输入总价",trigger:"blur"}],qu:[{required:!0,message:"请选择服务地区",trigger:"change"}],img:[{required:!0,message:"请上传详情图片",trigger:"blur"}]},ty1:{},ty2:{},ty3:{},checkedtypes:[],teacherid:""}},created:function(){this.getCityData(),this.id=this.$route.query.id,this.getcoureinfo(),this.gettypes()},mounted:function(){},methods:{getcoureinfo:function(){var e=this,t=this.$host+"admin/course/add_course";this.axios.get(t,{params:{course_id:this.id}}).then(function(t){if(console.log(t),200==t.status){var i=t.data;e.ptype=i.pcates,e.courenum=i.class_hour,e.differ=i.class_levels,e.coureInfo=i.course,e.typeid=i.users;for(var r=0;r<e.typeid.length;r++)e.typeid[r].value=e.typeid[r].user_nickname;e.restaurants=e.loadAll(),null!=e.coureInfo&&(e.selectedtype=e.coureInfo.course_type,e.dataset(),e.ruleForm.name=e.coureInfo.course_name,e.ruleForm.typeone=e.coureInfo.pid,e.teacherid=e.coureInfo.user_id,e.ruleForm.teacher=e.coureInfo.coach_name,e.ruleForm.courenum=e.coureInfo.class_id,e.ruleForm.singleP=e.coureInfo.unit_price,e.ruleForm.totalP=e.coureInfo.total_price,e.ruleForm.date1=e.coureInfo.course_start_time,e.ruleForm.date2=e.coureInfo.course_end_time,e.ruleForm.date3=e.coureInfo.coupon_start_time,e.ruleForm.date4=e.coureInfo.coupon_end_time,e.ruleForm.coupon=e.coureInfo.coupon_amount,e.ruleForm.differ=e.coureInfo.course_level,e.ruleForm.videoUrl=e.coureInfo.course_video,e.ruleForm.imageUrl1=e.coureInfo.course_cover,e.citys=e.coureInfo.service_region,e.ueditor.value=e.coureInfo.description)}else e.$message.error("网络错误！请稍后重试！")})},gettypes:function(){var e=this,t=this.$host+"home/get_cate";this.axios.get(t).then(function(t){e.types=t.data.result}).catch(function(e){console.log(e)})},chooseStype:function(e){var t=this,i={pid:this.ruleForm.typeone},r=this.$host+"admin/cate/show_child";this.axios.post(r,i).then(function(i){if(200==i.status){var r=i.data;t.Stype=r.result,0!=t.Stype.length?t.ruleForm.typetwo=1==e?Number(t.coureInfo.sid):t.Stype[0].id:t.ruleForm.typetwo=""}else t.$message.error("网络错误！请稍后重试！")})},choosetype:function(e,t,i){if(this.selectedtype=[],this.checkedtypes=[],1==e){var r={};t!=this.isChange?(this.isChange=t,r.pid=i.pid,r.id=i.id):(r={},this.isChange=-1),r.pid&&r.id?this.ty1=r:this.ty1={}}else if(2==e){var s={};t!=this.isChange1?(this.isChange1=t,s.pid=i.pid,s.id=i.id):(s={},this.isChange1=-1),s.pid&&s.id?this.ty2=s:this.ty2={}}else if(3==e){var o={};t!=this.isChange2?(this.isChange2=t,o.pid=i.pid,o.id=i.id):(o={},this.isChange2=-1),o.pid&&o.id?this.ty3=o:this.ty3={}}this.ty1.pid&&this.ty1.id&&this.selectedtype.push(this.ty1),this.ty2.pid&&this.ty2.id&&this.selectedtype.push(this.ty2),this.ty3.pid&&this.ty3.id&&this.selectedtype.push(this.ty3),this.dataset()},dataset:function(){for(var e=0;e<this.selectedtype.length;e++){var t;t=this.selectedtype[e].id,this.checkedtypes.push(t)}},getCityData:function(){var e=this;this.axios.get(this.mapJson).then(function(t){if(200==t.status){var i=t.data;for(var r in e.province=[],e.city=[],e.block=[],i)r.match(/0000$/)?e.province.push({id:r,value:i[r],children:[]}):r.match(/00$/)?e.city.push({id:r,value:i[r],children:[]}):e.block.push({id:r,value:i[r]});for(var s in e.province)for(var o in e.city)e.province[s].id.slice(0,2)===e.city[o].id.slice(0,2)&&e.province[s].children.push(e.city[o]);for(var l in e.city)for(var a in e.block)e.block[a].id.slice(0,4)===e.city[l].id.slice(0,4)&&e.city[l].children.push(e.block[a])}}).catch(function(e){console.log(s()(+e))})},choseProvince:function(e){for(var t in console.log(e),this.province)e===this.province[t].value&&(this.shi1=this.province[t].children,this.shi=this.province[t].children[0].value,this.qu1=this.province[t].children[0].children,this.qu=this.province[t].children[0].children[0].value,this.E=this.qu1[0].value)},choseCity:function(e){for(var t in this.city)e===this.city[t].value&&(this.qu1=this.city[t].children,this.qu=this.city[t].children[0].value,this.E=this.qu1[0].value)},choseBlock:function(e){this.E=e},add:function(){var e=[];""!=this.ruleForm.qu?(e.push(this.ruleForm.sheng,this.ruleForm.shi,this.ruleForm.qu),this.citys.push(e)):this.$message.error("请选择服务区！")},delcity:function(e){this.citys.splice(e,1)},handleVideoSuccess:function(e,t){this.ruleForm.videoUrl=e.dest},delvideo:function(){this.ruleForm.videoUrl=""},handlePreview:function(e){var t=e.dest;this.ruleForm.imageUrl1.push(t)},del:function(e){this.ruleForm.imageUrl1.splice(e,1)},save:function(){var e=this;this.ueditor.value=this.$refs.ue.getUEContent();var t={course_id:this.id,course_name:this.ruleForm.name,course_type:this.selectedtype,user_id:this.teacherid,course_level:this.ruleForm.differ,class_id:this.ruleForm.courenum,unit_price:this.ruleForm.singleP,total_price:this.ruleForm.totalP,course_start_time:this.ruleForm.date1,course_end_time:this.ruleForm.date2,coupon_amount:this.ruleForm.coupon,coupon_start_time:this.ruleForm.date3,coupon_end_time:this.ruleForm.date4,service_region:this.citys,course_video:this.ruleForm.videoUrl,course_cover:this.ruleForm.imageUrl1,description:this.ueditor.value},i=this.$host+"admin/course/save_course";this.axios.post(i,t).then(function(t){if(console.log(t),200==t.status){var i=t.data;1==i.code?(e.$message({message:i.msg,type:"success"}),e.$router.push("/courelist")):e.$message.error(i.msg)}else e.$message.error("网络错误！请稍后重试！")}).catch(function(t){e.$message.error("网络错误！请稍后重试！"),console.log(t)})},loadAll:function(){return this.typeid},querySearchAsync:function(e,t){var i=this.restaurants,r=e?i.filter(this.createStateFilter(e)):i;clearTimeout(this.timeout),this.timeout=setTimeout(function(){t(r)},3e3*Math.random())},createStateFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},handleSelect:function(e){this.teacherid=e.user_id}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"addcoure"},[i("div",{staticClass:"content bg-f"},[i("div",{staticClass:"top space-between padding-24"},[i("p",[e._v("编辑课程")]),e._v(" "),i("div",{staticClass:"btn save bg-active color-f",on:{click:function(t){return e.save()}}},[e._v("保存")])]),e._v(" "),i("div",{staticClass:"mine padding-24"},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"课程名称：",prop:"name"}},[i("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入课程名称"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}}),i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.ruleForm.name.length)+"/20")])],1),e._v(" "),i("el-form-item",{attrs:{label:"类型：",prop:"typetwo"}},[i("div",{staticClass:"types"},[i("p",[e._v(e._s(e.types[0].cate_name)+":")]),e._v(" "),e._l(e.types[0].son,function(t,r){return i("div",{key:r},[i("span",{class:{active:-1!=e.checkedtypes.indexOf(t.id)},on:{click:function(i){return e.choosetype(1,r,t)}}},[e._v(e._s(t.cate_name))])])})],2),e._v(" "),i("div",{staticClass:"types"},[i("p",[e._v(e._s(e.types[1].cate_name)+":")]),e._v(" "),e._l(e.types[1].son,function(t,r){return i("div",{key:r},[i("span",{class:{active:-1!=e.checkedtypes.indexOf(t.id)},on:{click:function(i){return e.choosetype(2,r,t)}}},[e._v(e._s(t.cate_name))])])})],2),e._v(" "),i("div",{staticClass:"types"},[i("p",[e._v(e._s(e.types[2].cate_name)+":")]),e._v(" "),e._l(e.types[2].son,function(t,r){return i("div",{key:r},[i("span",{class:{active:-1!=e.checkedtypes.indexOf(t.id)},on:{click:function(i){return e.choosetype(3,r,t)}}},[e._v(e._s(t.cate_name))])])})],2)]),e._v(" "),i("el-form-item",{attrs:{label:"教练：",prop:"teacher"}},[i("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请选择教练"},on:{select:e.handleSelect},model:{value:e.ruleForm.teacher,callback:function(t){e.$set(e.ruleForm,"teacher",t)},expression:"ruleForm.teacher"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"课时：",prop:"courenum"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.courenum,callback:function(t){e.$set(e.ruleForm,"courenum",t)},expression:"ruleForm.courenum"}},e._l(e.courenum,function(e){return i("el-option",{key:e.id,attrs:{label:e.course_number,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"难度：",prop:"differ"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.differ,callback:function(t){e.$set(e.ruleForm,"differ",t)},expression:"ruleForm.differ"}},e._l(e.differ,function(e){return i("el-option",{key:e.id,attrs:{label:e.course_level,value:e.id}})}),1)],1),e._v(" "),i("div",{staticClass:"flex"},[i("el-form-item",{attrs:{label:"单价：",prop:"singleP"}},[i("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入单价"},model:{value:e.ruleForm.singleP,callback:function(t){e.$set(e.ruleForm,"singleP",t)},expression:"ruleForm.singleP"}}),i("span",{staticStyle:{"margin-left":"10px"}},[e._v("元")])],1),e._v(" "),i("el-form-item",{attrs:{label:"总价：",prop:"totalP"}},[i("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入总价"},model:{value:e.ruleForm.totalP,callback:function(t){e.$set(e.ruleForm,"totalP",t)},expression:"ruleForm.totalP"}}),i("span",{staticStyle:{"margin-left":"10px"}},[e._v("元")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"课程有效期：",required:""}},[i("el-col",{attrs:{span:5}},[i("el-form-item",[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.date1,callback:function(t){e.$set(e.ruleForm,"date1",t)},expression:"ruleForm.date1"}})],1)],1),e._v(" "),i("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.date2,callback:function(t){e.$set(e.ruleForm,"date2",t)},expression:"ruleForm.date2"}})],1)],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"设置优惠券："}},[i("el-input",{staticStyle:{width:"215px"},attrs:{placeholder:"请输入优惠券金额"},model:{value:e.ruleForm.coupon,callback:function(t){e.$set(e.ruleForm,"coupon",t)},expression:"ruleForm.coupon"}}),i("span",{staticStyle:{"margin-left":"10px"}},[e._v("元")])],1),e._v(" "),i("el-form-item",{attrs:{label:"优惠券有效期："}},[i("el-col",{attrs:{span:5}},[i("el-form-item",[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.date3,callback:function(t){e.$set(e.ruleForm,"date3",t)},expression:"ruleForm.date3"}})],1)],1),e._v(" "),i("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),e._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.date4,callback:function(t){e.$set(e.ruleForm,"date4",t)},expression:"ruleForm.date4"}})],1)],1)],1),e._v(" "),i("div",{staticClass:"flex"},[i("el-form-item",{attrs:{label:"服务地址：",prop:"qu"}},[i("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择省"},on:{change:e.choseProvince},model:{value:e.ruleForm.sheng,callback:function(t){e.$set(e.ruleForm,"sheng",t)},expression:"ruleForm.sheng"}},e._l(e.province,function(e){return i("el-option",{key:e.id,attrs:{label:e.value,value:e.value}})}),1),e._v(" "),i("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择市"},on:{change:e.choseCity},model:{value:e.ruleForm.shi,callback:function(t){e.$set(e.ruleForm,"shi",t)},expression:"ruleForm.shi"}},e._l(e.shi1,function(e){return i("el-option",{key:e.id,attrs:{label:e.value,value:e.value}})}),1),e._v(" "),i("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择区"},on:{change:e.choseBlock},model:{value:e.ruleForm.qu,callback:function(t){e.$set(e.ruleForm,"qu",t)},expression:"ruleForm.qu"}},e._l(e.qu1,function(e){return i("el-option",{key:e.id,attrs:{label:e.value,value:e.value}})}),1)],1),e._v(" "),i("div",{staticClass:"add bg-active color-f",on:{click:e.add}},[e._v("添加")])],1),e._v(" "),i("div",{staticClass:"citylist"},[i("p",[e._v("已选城市：")]),e._v(" "),i("ul",e._l(e.citys,function(t,r){return i("li",{key:r,staticClass:"space-between"},[i("p",[e._v(e._s(t[0]+t[1]+t[2]))]),e._v(" "),i("p",{staticClass:"color-active btn",on:{click:function(t){return e.delcity(r)}}},[e._v("删除")])])}),0)]),e._v(" "),i("el-form-item",{attrs:{label:"详情头部",prop:"img"}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:"https://test.izhixiu.cn/www/yoga/upload_video","show-file-list":!1,"on-success":e.handleVideoSuccess}},[i("el-button",{staticStyle:{position:"absolute",left:"10px","margin-top":"-20px"},attrs:{size:"small",type:"primary"}},[e._v("上传视频")])],1),e._v(" "),""!=e.ruleForm.videoUrl?i("div",{staticClass:"videoBox",staticStyle:{"margin-top":"20px"}},[""!=e.ruleForm.videoUrl?i("span",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.delvideo()}}},[i("i",{staticClass:"el-icon-circle-close"})]):e._e(),e._v(" "),""!=e.ruleForm.videoUrl?i("video",{staticStyle:{width:"250px",height:"120px"},attrs:{src:e.ruleForm.videoUrl,controls:""}}):e._e()]):e._e(),e._v(" "),i("el-upload",{staticClass:"upload-demo",attrs:{action:"https://test.izhixiu.cn/www/yoga/upload_file","on-success":e.handlePreview,"list-type":"picture","show-file-list":!1,multiple:e.multiple}},[i("el-button",{staticStyle:{position:"absolute",left:"10px","margin-top":"-20px"},attrs:{size:"small",type:"primary"}},[e._v("上传图片")]),e._v(" "),i("div",{staticStyle:{position:"absolute",left:"100px","margin-top":"-20px"}},[e._v("（注：建议尺寸750 *584px）")])],1),e._v(" "),""!=e.ruleForm.imageUrl1.img?i("div",{staticClass:"imgBox",staticStyle:{"margin-top":"30px"}},[i("ul",e._l(e.ruleForm.imageUrl1,function(t,r){return i("li",{key:r},[i("span",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.del(r)}}},[i("i",{staticClass:"el-icon-circle-close"})]),e._v(" "),i("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t}})])}),0)]):e._e()],1),e._v(" "),i("el-form-item",{attrs:{label:"课程介绍："}},[i("editor",{ref:"ue",attrs:{value:e.ueditor.value,config:e.ueditor.config}})],1)],1)],1)])])},staticRenderFns:[]};var a=i("VU/8")(o,l,!1,function(e){i("i5Me")},null,null);t.default=a.exports},i5Me:function(e,t){}});
//# sourceMappingURL=11.cc8774e5d8e8773a7212.js.map